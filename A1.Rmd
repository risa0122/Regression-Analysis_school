---
title: "과제1 - 2장 연습문제 과제"
output: html_document
---


2-2 주어진 행렬과 벡터를 이용하여 계산하시오.  
A =
$$\left[\begin{array}{rrr} 
1&-1&2\\
-1&3&3\\
2&3&4
\end{array}\right]$$
B = 
$$\left[\begin{array}{rrr} 
3&-2&4\\
-2&1&0\\
4&0&2
\end{array}\right]$$
x = 
$$\left[\begin{array}{rrr} 
1\\
2\\
3
\end{array}\right]$$
y = 
$$\left[\begin{array}{rrr} 
3\\
5\\
4
\end{array}\right]$$

###(a) A+B
```{r}
A = matrix(c(1,-1,2,-1,3,3,2,3,4),ncol=3)
B = matrix(c(3,-2,4,-2,1,0,4,0,2),ncol=3)
x = c(1,2,3)
y = c(3,5,4)

A+B
```
###(b) A'
```{r}
t(A)
```
###(c) x'Ay
```{r}
t(x)%*%A%*%y
```
###(d) x'x
```{r}
t(x)*x
```
###(e) x'Ax
```{r}
t(x)%*%A%*%x
```
###(f) x'y
```{r}
t(x)*y
```
###(g) A'A
```{r}
t(A)%*%A
```
###(h) AB 
```{r}
A%*%B
```
###(i) y'B
```{r}
t(y)%*%B
```
###(j) xx'
```{r}
x*t(x)
```
###(k) x+y
```{r}
x+y
```
###(l) x-y
```{r}
x-y
```
###(m) (x-y)'
```{r}
t(x-y)
```
###(n) xy'
```{r}
x*t(y)
```
###(o) A-B
```{r}
A-B
```
###(p) A'+B'
```{r}
t(A)+t(B)
```
###(q) (A+B)'
```{r}
t(A+B)
```
###(r) 3x
```{r}
3*x
```
 
###(s) 
$$(x'y)^{2}$$
```{r}
(t(x)*y)^2
```
###(t) BA
```{r}
B%*%A
```
###(u) rank(A)
```{r}
#install.packages("Matrix")
library(Matrix)
rankMatrix(A)
```
###(v) 
$$A^{-1}$$
```{r}
#install.packages("MASS")
library(MASS)
ginv(A)
```
###(w) tr(A)와 tr(B)를 구하시오. 
```{r}
#install.packages("psych")
library(psych)
tr(A)
tr(B)
```
###(x) tr(A+B) = tr(A)+tr(B)임을 보이시오. 
```{r}
isTRUE(tr(A+B) == tr(A)+tr(B))
```
###(y) tr(AB) = tr(BA)임을 보이시오.
```{r}
isTRUE(tr(A%*%B) == tr(B%*%A))
```
###(z) (AB)'= B'A'임을 보이시오.
```{r}
t(A%*%B) == t(B)%*%t(A)
```


2.4 확률벡터 X의 공분산행렬이  
Σ =
$$\left[\begin{array}{rrr} 
1&0&0\\
0&9&0\\
0&0&16
\end{array}\right]$$
일 때,  
###(a) rank(Σ)를 구하시오.

```{r}
X = matrix(c(1,0,0,0,9,0,0,0,16),nc=3)

library(Matrix)
rankMatrix(X)
```
###(b) Σ의 고유값과 고유벡터, 단위 고유벡터를 구하시오.
```{r}
e = eigen(X)   
e  #고유값, 고유벡터
e$vectors/sqrt(3)   #단위고유벡터
```
###(c) 
$$Σ^{-1}$$
###를 구하시오
```{r}
library(MASS)
ginv(X)
```
###(d) Σ를 스펙트럼분해로 포현하시오.
```{r}
#install.packages("OpenMx")
library(OpenMx)
P = e$vectors
L = vec2diag(e$values)
P%*%L%*%t(P)
```
###(e) 
$$Σ^{-1}$$
###의 고유값과 고유벡터를 구하시오.
```{r}
xx = ginv(X)
lambdaxx = eigen(xx)   
lambdaxx  #고유값, 고유벡터
```
###(f) Σ는 양정치행렬인가?
```{r}
x = c(-1,-2,-3)    #임의의 벡터 x선언
t(x)%*%X%*%x>0  #결과가 TRUE이므로 양정치행렬이다.
```
###(g) Σ를 이용하여 X의 상관행렬을 구하시오.
```{r}
cov2cor(X)
```
###(h) |Σ|를 구하고 고유값들의 곱과 일치하는지 알아보시오
```{r}
#e$values = 16,9,1임
det(X) == 16*9*1  #일치한다
```
###(i) tr(Σ)를 구하고 고유값들의 합과 일치하는지 알아보시오 
```{r}
library(psych)
tr(X) == 16+9+1   #일치한다
```


2-5 행렬  
A = 
$$\left[\begin{array}{rrr} 
5&-4&3\\
-4&8&6\\
3&6&9
\end{array}\right]$$
에 대해  
###(a) 고유값과 고유벡터를 구하시오. 
```{r}
AA = matrix(c(5,-4,3,-4,8,6,3,6,9),nc=3)

e2 = eigen(AA)
e2
```
###(b) tr(A)를 구하고 고유값들의 합과 같은지 확인해 보시오.
```{r}
library(psych)
# > e2$values
# [1] 14.554216  8.844169 -1.398385
tr(AA) == (14.554216 + 8.844169 + -1.398385)
```
###(c) |A|를 구하과 고유값들의 곱과 같은지 확인해 보시오. 
```{r}
# > e2$values
# [1] 14.554216  8.844169 -1.398385
det(AA) == as.integer(14.554216 * 8.844169 *(-1.398385))
```
###(d) 
$$A^{-1}$$
###를 구하시오.
```{r}
library(MASS)
ginv(AA)
```
